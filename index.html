<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
  <title>Smooth Cube Rotation</title>
</head>
<body>
  <a-scene vr-mode-ui="enabled: true">
    <!-- A Rotating Cube -->
    <a-box 
      id="rotatingCube" 
      position="0 1.5 -3" 
      color="blue" 
      depth="1" 
      height="1" 
      width="1">
    </a-box>

    <!-- Add Camera and Controllers -->
    <a-entity camera look-controls wasd-controls>
      <a-entity
        id="rightController"
        laser-controls="hand: right"
        raycaster="objects: .clickable"
        thumbstick-moved>
      </a-entity>
    </a-entity>
  </a-scene>

  <script>
    const cube = document.querySelector("#rotatingCube");
    const rightController = document.querySelector("#rightController");

    // Store cube rotation state
    let rotation = { x: 0, y: 0, z: 0 };

    // Smooth joystick handling via gamepad polling
    function updateCubeRotation() {
      const controllers = navigator.getGamepads();
      const rightHandController = controllers.find(controller => controller && controller.hand === "right");

      if (rightHandController) {
        const joystick = rightHandController.axes;

        if (joystick) {
          // Continuous updates based on joystick values
          rotation.x += joystick[1] * 2; // Y-axis on joystick affects cube X rotation
          rotation.y += joystick[0] * 2; // X-axis on joystick affects cube Y rotation
          cube.setAttribute("rotation", `${rotation.x} ${rotation.y} ${rotation.z}`);
        }
      }

      // Smooth loop
      requestAnimationFrame(updateCubeRotation);
    }

    // Start the update loop
    updateCubeRotation();
  </script>
</body>
</html>
